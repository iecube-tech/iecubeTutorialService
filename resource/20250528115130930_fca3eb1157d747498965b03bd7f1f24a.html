<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>拉格朗日中值定理详解</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            --color-primary: #3B82F6;
            --color-secondary: #1E40AF;
            --color-accent: #F59E0B;
            --color-success: #10B981;
            --color-warning: #EF4444;
            --color-light: #F8FAFC;
            --color-dark: #0F172A;
            --shadow-soft: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-medium: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .dark {
            --color-light: #1E293B;
            --color-dark: #F1F5F9;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-medium);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .math-container {
            background: linear-gradient(145deg, #f8fafc, #e2e8f0);
            border-left: 4px solid var(--color-primary);
        }
        
        .dark .math-container {
            background: linear-gradient(145deg, #334155, #475569);
        }
        
        canvas {
            border-radius: 12px;
            box-shadow: var(--shadow-soft);
        }
        
        .pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300">
    <!-- 顶部导航 -->
    <nav class="bg-white dark:bg-gray-800 shadow-lg sticky top-0 z-50 transition-colors duration-300">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fas fa-function text-2xl text-blue-600"></i>
                <h1 class="text-xl font-bold">高等数学</h1>
            </div>
            <button id="themeToggle" class="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                <i class="fas fa-moon dark:hidden"></i>
                <i class="fas fa-sun hidden dark:block"></i>
            </button>
        </div>
    </nav>

    <main class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- 课程标题区域 -->
        <header class="text-center mb-12 fade-in">
            <div class="gradient-bg text-white rounded-2xl p-8 mb-8">
                <i class="fas fa-calculator text-4xl mb-4 text-yellow-300"></i>
                <h1 class="text-4xl md:text-5xl font-bold mb-4">拉格朗日中值定理</h1>
                <p class="text-xl opacity-90">微分学中的核心定理：连接函数值差与导数的桥梁</p>
            </div>
        </header>

        <!-- 概述 -->
        <section class="mb-12 fade-in">
            <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg hover-lift">
                <h2 class="text-3xl font-bold mb-6 flex items-center">
                    <i class="fas fa-lightbulb text-yellow-500 mr-3"></i>
                    什么是拉格朗日中值定理？
                </h2>
                <p class="text-lg mb-6 leading-relaxed">
                    拉格朗日中值定理是微分学中最重要的定理之一，它揭示了函数在闭区间上的平均变化率与某一点处的瞬时变化率之间的关系。这个定理为我们提供了从整体到局部的重要联系。
                </p>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-blue-50 dark:bg-blue-900/20 p-6 rounded-xl">
                        <h3 class="font-semibold text-lg mb-3 text-blue-700 dark:text-blue-300">几何意义</h3>
                        <p>在函数图像上，存在至少一条切线与连接端点的割线平行</p>
                    </div>
                    <div class="bg-green-50 dark:bg-green-900/20 p-6 rounded-xl">
                        <h3 class="font-semibold text-lg mb-3 text-green-700 dark:text-green-300">物理意义</h3>
                        <p>在运动过程中，某一瞬间的速度等于全程的平均速度</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 定理表述 -->
        <section class="mb-12 fade-in">
            <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg">
                <h2 class="text-3xl font-bold mb-6 flex items-center">
                    <i class="fas fa-scroll text-purple-500 mr-3"></i>
                    定理表述
                </h2>
                <div class="math-container p-8 rounded-xl mb-6">
                    <h3 class="text-xl font-semibold mb-4">定理内容</h3>
                    <p class="mb-4">设函数 $f(x)$ 满足：</p>
                    <ol class="list-decimal list-inside space-y-2 mb-6">
                        <li>在闭区间 $[a,b]$ 上连续</li>
                        <li>在开区间 $(a,b)$ 内可导</li>
                    </ol>
                    <p class="mb-4">则在开区间 $(a,b)$ 内至少存在一点 $\xi$，使得：</p>
                    <div class="text-center text-2xl bg-white dark:bg-gray-700 p-6 rounded-lg border-2 border-blue-300">
                        $$f'(\xi) = \frac{f(b) - f(a)}{b - a}$$
                    </div>
                </div>
            </div>
        </section>

        <!-- 定理条件详解 -->
        <section class="mb-12 fade-in">
            <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg">
                <h2 class="text-3xl font-bold mb-6 flex items-center">
                    <i class="fas fa-list-check text-orange-500 mr-3"></i>
                    定理条件详解
                </h2>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-xl">
                        <h3 class="font-semibold text-lg mb-3 flex items-center">
                            <i class="fas fa-arrow-trend-up text-blue-600 mr-2"></i>
                            连续性条件
                        </h3>
                        <p class="mb-3">函数在 $[a,b]$ 上连续确保：</p>
                        <ul class="space-y-1 text-sm">
                            <li>• 函数值存在且有限</li>
                            <li>• 没有跳跃间断点</li>
                            <li>• 保证极值定理适用</li>
                        </ul>
                    </div>
                    <div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-6 rounded-xl">
                        <h3 class="font-semibold text-lg mb-3 flex items-center">
                            <i class="fas fa-chart-line text-green-600 mr-2"></i>
                            可导性条件
                        </h3>
                        <p class="mb-3">函数在 $(a,b)$ 内可导确保：</p>
                        <ul class="space-y-1 text-sm">
                            <li>• 导数存在</li>
                            <li>• 切线斜率有定义</li>
                            <li>• 局部线性化可行</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- 交互式动画演示 -->
        <section class="mb-12 fade-in">
            <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg">
                <h2 class="text-3xl font-bold mb-6 flex items-center">
                    <i class="fas fa-play text-red-500 mr-3"></i>
                    交互式几何演示
                </h2>
                <div class="mb-6">
                    <div class="flex flex-wrap gap-4 mb-4">
                        <button id="startAnimation" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-play mr-2"></i>开始演示
                        </button>
                        <button id="resetAnimation" class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-undo mr-2"></i>重置
                        </button>
                        <button id="pauseAnimation" class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-pause mr-2"></i>暂停
                        </button>
                    </div>
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">区间左端点 a:</label>
                            <input type="range" id="pointA" min="0" max="2" step="0.1" value="0.5" class="w-full">
                            <span id="pointAValue" class="text-sm text-gray-600">0.5</span>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">区间右端点 b:</label>
                            <input type="range" id="pointB" min="3" max="5" step="0.1" value="4.5" class="w-full">
                            <span id="pointBValue" class="text-sm text-gray-600">4.5</span>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-xl">
                    <canvas id="lagrangeCanvas" width="800" height="500" class="w-full max-w-full"></canvas>
                </div>
                <div class="mt-4 text-sm text-gray-600 dark:text-gray-400">
                    <p><strong>说明：</strong>红色线段为割线，绿色线段为切线。观察切线如何与割线平行。</p>
                </div>
            </div>
        </section>

        <!-- 推导过程 -->
        <section class="mb-12 fade-in">
            <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg">
                <h2 class="text-3xl font-bold mb-6 flex items-center">
                    <i class="fas fa-cogs text-indigo-500 mr-3"></i>
                    定理推导过程
                </h2>
                <div class="space-y-6">
                    <div class="bg-yellow-50 dark:bg-yellow-900/20 p-6 rounded-xl border-l-4 border-yellow-400">
                        <h3 class="font-semibold text-lg mb-3">推导思路</h3>
                        <p>构造辅助函数，利用罗尔定理证明拉格朗日中值定理。</p>
                    </div>
                    
                    <div class="space-y-4">
                        <h4 class="text-xl font-semibold">步骤 1: 构造辅助函数</h4>
                        <p>设辅助函数：</p>
                        <div class="math-container p-4 rounded-lg">
                            $$F(x) = f(x) - f(a) - \frac{f(b)-f(a)}{b-a}(x-a)$$
                        </div>
                        <p class="text-sm text-gray-600 dark:text-gray-400">这个函数表示原函数与过端点直线的垂直距离</p>
                    </div>
                    
                    <div class="space-y-4">
                        <h4 class="text-xl font-semibold">步骤 2: 验证罗尔定理条件</h4>
                        <ul class="space-y-2">
                            <li>• $F(x)$ 在 $[a,b]$ 上连续（$f(x)$ 连续）</li>
                            <li>• $F(x)$ 在 $(a,b)$ 内可导（$f(x)$ 可导）</li>
                            <li>• $F(a) = F(b) = 0$</li>
                        </ul>
                    </div>
                    
                    <div class="space-y-4">
                        <h4 class="text-xl font-semibold">步骤 3: 应用罗尔定理</h4>
                        <p>由罗尔定理，存在 $\xi \in (a,b)$ 使得：</p>
                        <div class="math-container p-4 rounded-lg">
                            $$F'(\xi) = 0$$
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <h4 class="text-xl font-semibold">步骤 4: 计算导数并得出结论</h4>
                        <div class="math-container p-4 rounded-lg">
                            $$F'(x) = f'(x) - \frac{f(b)-f(a)}{b-a}$$
                        </div>
                        <p>由 $F'(\xi) = 0$ 得：</p>
                        <div class="math-container p-4 rounded-lg">
                            $$f'(\xi) = \frac{f(b)-f(a)}{b-a}$$
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 应用实例 -->
        <section class="mb-12 fade-in">
            <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg">
                <h2 class="text-3xl font-bold mb-6 flex items-center">
                    <i class="fas fa-example text-green-500 mr-3"></i>
                    经典应用实例
                </h2>
                
                <div class="grid md:grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- 例题1 -->
                    <div class="bg-blue-50 dark:bg-blue-900/20 p-6 rounded-xl">
                        <h3 class="font-semibold text-lg mb-4">例题 1：验证定理</h3>
                        <p class="mb-3"><strong>题目：</strong>验证函数 $f(x) = x^2$ 在 $[1,3]$ 上满足拉格朗日中值定理，并求出 $\xi$ 的值。</p>
                        
                        <div class="space-y-3">
                            <p><strong>解：</strong></p>
                            <p>1. 验证条件：$f(x) = x^2$ 在 $[1,3]$ 上连续，在 $(1,3)$ 内可导。</p>
                            <p>2. 计算：$f(3) = 9$，$f(1) = 1$，$f'(x) = 2x$</p>
                            <div class="math-container p-3 rounded-lg text-center">
                                $$\frac{f(3)-f(1)}{3-1} = \frac{9-1}{2} = 4$$
                            </div>
                            <p>3. 由 $f'(\xi) = 2\xi = 4$，得 $\xi = 2$</p>
                            <p class="text-green-700 dark:text-green-300">验证：$\xi = 2 \in (1,3)$ ✓</p>
                        </div>
                    </div>
                    
                    <!-- 例题2 -->
                    <div class="bg-purple-50 dark:bg-purple-900/20 p-6 rounded-xl">
                        <h3 class="font-semibold text-lg mb-4">例题 2：不等式证明</h3>
                        <p class="mb-3"><strong>题目：</strong>证明当 $x > 0$ 时，$\ln(1+x) < x$。</p>
                        
                        <div class="space-y-3">
                            <p><strong>证明：</strong></p>
                            <p>1. 设 $f(t) = \ln(1+t)$，在 $[0,x]$ 上应用拉格朗日中值定理</p>
                            <p>2. 存在 $\xi \in (0,x)$ 使得：</p>
                            <div class="math-container p-3 rounded-lg text-center">
                                $$f'(\xi) = \frac{f(x)-f(0)}{x-0} = \frac{\ln(1+x)}{x}$$
                            </div>
                            <p>3. 因为 $f'(t) = \frac{1}{1+t}$，所以 $f'(\xi) = \frac{1}{1+\xi}$</p>
                            <p>4. 由于 $\xi > 0$，得 $\frac{1}{1+\xi} < 1$</p>
                            <p class="text-green-700 dark:text-green-300">因此：$\ln(1+x) = x \cdot \frac{1}{1+\xi} < x$ ✓</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 重要推论 -->
        <section class="mb-12 fade-in">
            <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg">
                <h2 class="text-3xl font-bold mb-6 flex items-center">
                    <i class="fas fa-star text-amber-500 mr-3"></i>
                    重要推论与应用
                </h2>
                
                <div class="grid md:grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="bg-gradient-to-br from-red-50 to-pink-50 dark:from-red-900/20 dark:to-pink-900/20 p-6 rounded-xl">
                        <h3 class="font-semibold text-lg mb-3 text-red-700 dark:text-red-300">推论 1</h3>
                        <p class="mb-2"><strong>单调性判断</strong></p>
                        <p class="text-sm">若在区间 $I$ 上 $f'(x) > 0$，则 $f(x)$ 在 $I$ 上严格单调递增</p>
                    </div>
                    
                    <div class="bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 p-6 rounded-xl">
                        <h3 class="font-semibold text-lg mb-3 text-blue-700 dark:text-blue-300">推论 2</h3>
                        <p class="mb-2"><strong>函数最值</strong></p>
                        <p class="text-sm">结合费马定理，可以找到函数的极值点和最值</p>
                    </div>
                    
                    <div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-6 rounded-xl">
                        <h3 class="font-semibold text-lg mb-3 text-green-700 dark:text-green-300">推论 3</h3>
                        <p class="mb-2"><strong>中值不等式</strong></p>
                        <p class="text-sm">建立函数值与导数之间的定量关系，证明各类不等式</p>
                    </div>
                </div>
                
                <div class="mt-8 p-6 bg-amber-50 dark:bg-amber-900/20 rounded-xl border-l-4 border-amber-400">
                    <h3 class="font-semibold text-lg mb-3">实际应用场景</h3>
                    <ul class="space-y-2">
                        <li><strong>物理学：</strong>运动学中平均速度与瞬时速度的关系</li>
                        <li><strong>经济学：</strong>边际成本与平均成本的关系分析</li>
                        <li><strong>工程学：</strong>优化问题中的约束条件分析</li>
                        <li><strong>数值分析：</strong>误差估计和算法收敛性证明</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- 思考题部分 -->
        <section class="mb-12">
            <div class="bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-2xl p-8 shadow-lg">
                <h2 class="text-3xl font-bold mb-6 flex items-center">
                    <i class="fas fa-brain mr-3"></i>
                    思考与练习
                </h2>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-white/10 p-6 rounded-xl">
                        <h3 class="font-semibold text-lg mb-4">思考题</h3>
                        <ol class="space-y-3 text-sm">
                            <li>1. 为什么拉格朗日中值定理要求函数在端点处连续，而在内部可导？</li>
                            <li>2. 如果函数在某点不可导，拉格朗日中值定理还成立吗？</li>
                            <li>3. 拉格朗日中值定理中的 $\xi$ 是否唯一？举例说明。</li>
                        </ol>
                    </div>
                    
                    <div class="bg-white/10 p-6 rounded-xl">
                        <h3 class="font-semibold text-lg mb-4">练习题</h3>
                        <ol class="space-y-3 text-sm">
                            <li>1. 证明：当 $a > 0$ 时，$\frac{1}{1+a} < \ln(1+a) < a$</li>
                            <li>2. 利用拉格朗日中值定理证明：$|\sin x - \sin y| \leq |x - y|$</li>
                            <li>3. 求函数 $f(x) = x^3 - 3x$ 在 $[0,2]$ 上的拉格朗日中值点</li>
                        </ol>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- 页脚信息 -->
    <footer class="bg-gray-800 dark:bg-gray-900 text-white py-8 mt-16">
        <div class="container mx-auto px-4 text-center">
            <div class="mb-4">
                <p class="text-lg font-semibold">© 2025 IECUBE Tutorial</p>
                <p class="text-sm text-gray-400 mt-2">本内容为人工智能生成，观点为转述原作者，不代表本公司立场，仅供参考和批判</p>
            </div>
        </div>
    </footer>

    <script>
        // 主题切换功能
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;

        // 检测系统主题
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        if (prefersDark) {
            html.classList.add('dark');
        }

        themeToggle.addEventListener('click', () => {
            html.classList.toggle('dark');
        });

        // KaTeX 渲染
        document.addEventListener('DOMContentLoaded', function () {
            renderMathInElement(document.body, {
                delimiters: [
                    { left: '$$', right: '$$', display: true },
                    { left: '$', right: '$', display: false }
                ]
            });
        });

        // 拉格朗日中值定理动画
        class LagrangeAnimation {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.width = canvas.width;
                this.height = canvas.height;
                this.isAnimating = false;
                this.animationId = null;
                
                this.a = 0.5;
                this.b = 4.5;
                this.xi = 2.5;
                this.showTangent = false;
                
                this.init();
            }

            init() {
                this.resize();
                this.draw();
            }

            resize() {
                const rect = this.canvas.getBoundingClientRect();
                this.canvas.width = rect.width * 2;
                this.canvas.height = rect.height * 2;
                this.ctx.scale(2, 2);
                this.width = rect.width;
                this.height = rect.height;
            }

            // 函数：f(x) = 0.2x^3 - x^2 + 2x + 1
            f(x) {
                return 0.2 * x * x * x - x * x + 2 * x + 1;
            }

            // 导数：f'(x) = 0.6x^2 - 2x + 2
            fprime(x) {
                return 0.6 * x * x - 2 * x + 2;
            }

            screenX(x) {
                return (x + 1) * this.width / 7;
            }

            screenY(y) {
                return this.height - (y + 2) * this.height / 6;
            }

            mathX(screenX) {
                return screenX * 7 / this.width - 1;
            }

            draw() {
                this.ctx.clearRect(0, 0, this.width, this.height);
                
                // 绘制坐标轴
                this.drawAxes();
                
                // 绘制函数曲线
                this.drawFunction();
                
                // 绘制端点
                this.drawEndpoints();
                
                // 绘制割线
                this.drawSecantLine();
                
                // 绘制切线（如果显示）
                if (this.showTangent) {
                    this.drawTangentLine();
                }
                
                // 绘制标签
                this.drawLabels();
            }

            drawAxes() {
                this.ctx.strokeStyle = '#6B7280';
                this.ctx.lineWidth = 1;
                this.ctx.setLineDash([]);
                
                // X轴
                this.ctx.beginPath();
                this.ctx.moveTo(0, this.screenY(0));
                this.ctx.lineTo(this.width, this.screenY(0));
                this.ctx.stroke();
                
                // Y轴
                this.ctx.beginPath();
                this.ctx.moveTo(this.screenX(0), 0);
                this.ctx.lineTo(this.screenX(0), this.height);
                this.ctx.stroke();
                
                // 刻度
                for (let x = -1; x <= 6; x++) {
                    if (x !== 0) {
                        this.ctx.beginPath();
                        this.ctx.moveTo(this.screenX(x), this.screenY(0) - 5);
                        this.ctx.lineTo(this.screenX(x), this.screenY(0) + 5);
                        this.ctx.stroke();
                    }
                }
                
                for (let y = -2; y <= 4; y++) {
                    if (y !== 0) {
                        this.ctx.beginPath();
                        this.ctx.moveTo(this.screenX(0) - 5, this.screenY(y));
                        this.ctx.lineTo(this.screenX(0) + 5, this.screenY(y));
                        this.ctx.stroke();
                    }
                }
            }

            drawFunction() {
                this.ctx.strokeStyle = '#3B82F6';
                this.ctx.lineWidth = 3;
                this.ctx.setLineDash([]);
                
                this.ctx.beginPath();
                for (let x = -0.5; x <= 6; x += 0.05) {
                    const y = this.f(x);
                    if (x === -0.5) {
                        this.ctx.moveTo(this.screenX(x), this.screenY(y));
                    } else {
                        this.ctx.lineTo(this.screenX(x), this.screenY(y));
                    }
                }
                this.ctx.stroke();
            }

            drawEndpoints() {
                const fa = this.f(this.a);
                const fb = this.f(this.b);
                
                // 端点
                this.ctx.fillStyle = '#EF4444';
                this.ctx.beginPath();
                this.ctx.arc(this.screenX(this.a), this.screenY(fa), 6, 0, 2 * Math.PI);
                this.ctx.fill();
                
                this.ctx.beginPath();
                this.ctx.arc(this.screenX(this.b), this.screenY(fb), 6, 0, 2 * Math.PI);
                this.ctx.fill();
            }

            drawSecantLine() {
                const fa = this.f(this.a);
                const fb = this.f(this.b);
                
                this.ctx.strokeStyle = '#EF4444';
                this.ctx.lineWidth = 2;
                this.ctx.setLineDash([5, 5]);
                
                this.ctx.beginPath();
                this.ctx.moveTo(this.screenX(this.a), this.screenY(fa));
                this.ctx.lineTo(this.screenX(this.b), this.screenY(fb));
                this.ctx.stroke();
            }

            drawTangentLine() {
                const fxi = this.f(this.xi);
                const slope = this.fprime(this.xi);
                
                // 计算切线端点
                const x1 = this.xi - 1;
                const x2 = this.xi + 1;
                const y1 = fxi + slope * (x1 - this.xi);
                const y2 = fxi + slope * (x2 - this.xi);
                
                this.ctx.strokeStyle = '#10B981';
                this.ctx.lineWidth = 2;
                this.ctx.setLineDash([]);
                
                this.ctx.beginPath();
                this.ctx.moveTo(this.screenX(x1), this.screenY(y1));
                this.ctx.lineTo(this.screenX(x2), this.screenY(y2));
                this.ctx.stroke();
                
                // ξ 点
                this.ctx.fillStyle = '#10B981';
                this.ctx.beginPath();
                this.ctx.arc(this.screenX(this.xi), this.screenY(fxi), 6, 0, 2 * Math.PI);
                this.ctx.fill();
            }

            drawLabels() {
                this.ctx.font = '14px Inter';
                this.ctx.fillStyle = '#374151';
                
                // 端点标签
                this.ctx.fillText('A(a, f(a))', this.screenX(this.a) - 30, this.screenY(this.f(this.a)) - 15);
                this.ctx.fillText('B(b, f(b))', this.screenX(this.b) + 10, this.screenY(this.f(this.b)) - 15);
                
                if (this.showTangent) {
                    this.ctx.fillStyle = '#10B981';
                    this.ctx.fillText('ξ', this.screenX(this.xi) - 5, this.screenY(this.f(this.xi)) - 15);
                }
                
                // 斜率信息
                const secantSlope = (this.f(this.b) - this.f(this.a)) / (this.b - this.a);
                this.ctx.fillStyle = '#6B7280';
                this.ctx.font = '12px Inter';
                this.ctx.fillText(`割线斜率: ${secantSlope.toFixed(3)}`, 20, this.height - 40);
                
                if (this.showTangent) {
                    const tangentSlope = this.fprime(this.xi);
                    this.ctx.fillText(`切线斜率: ${tangentSlope.toFixed(3)}`, 20, this.height - 20);
                }
            }

            animate() {
                if (!this.isAnimating) return;
                
                // 寻找满足条件的 xi
                const secantSlope = (this.f(this.b) - this.f(this.a)) / (this.b - this.a);
                
                // 数值方法寻找解
                for (let x = this.a + 0.01; x < this.b; x += 0.01) {
                    if (Math.abs(this.fprime(x) - secantSlope) < 0.01) {
                        this.xi = x;
                        break;
                    }
                }
                
                this.showTangent = true;
                this.draw();
            }

            start() {
                this.isAnimating = true;
                this.showTangent = false;
                setTimeout(() => {
                    this.animate();
                }, 1000);
            }

            reset() {
                this.isAnimating = false;
                this.showTangent = false;
                if (this.animationId) {
                    cancelAnimationFrame(this.animationId);
                }
                this.draw();
            }

            pause() {
                this.isAnimating = false;
            }

            updatePoints(a, b) {
                this.a = a;
                this.b = b;
                this.showTangent = false;
                this.draw();
            }
        }

        // 初始化动画
        const canvas = document.getElementById('lagrangeCanvas');
        const animation = new LagrangeAnimation(canvas);

        // 控制按钮事件
        document.getElementById('startAnimation').addEventListener('click', () => {
            animation.start();
        });

        document.getElementById('resetAnimation').addEventListener('click', () => {
            animation.reset();
        });

        document.getElementById('pauseAnimation').addEventListener('click', () => {
            animation.pause();
        });

        // 滑块事件
        const pointASlider = document.getElementById('pointA');
        const pointBSlider = document.getElementById('pointB');
        const pointAValue = document.getElementById('pointAValue');
        const pointBValue = document.getElementById('pointBValue');

        pointASlider.addEventListener('input', (e) => {
            const a = parseFloat(e.target.value);
            pointAValue.textContent = a.toFixed(1);
            animation.updatePoints(a, parseFloat(pointBSlider.value));
        });

        pointBSlider.addEventListener('input', (e) => {
            const b = parseFloat(e.target.value);
            pointBValue.textContent = b.toFixed(1);
            animation.updatePoints(parseFloat(pointASlider.value), b);
        });

        // 窗口调整大小事件
        window.addEventListener('resize', () => {
            animation.resize();
            animation.draw();
        });

        // 滚动动画
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('fade-in');
                }
            });
        }, observerOptions);

        document.querySelectorAll('section').forEach(section => {
            observer.observe(section);
        });
    </script>
</body>
</html>