<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>高等数学 - 求导</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        .dark-mode {
            background-color: #0f172a;
            color: #e2e8f0;
        }
        .animate-fade-in {
            animation: fadeIn 0.8s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .tangent-line {
            stroke: #ef4444;
            stroke-width: 3;
            opacity: 0.8;
        }
        .function-curve {
            stroke: #3b82f6;
            stroke-width: 3;
            fill: none;
        }
        .point-marker {
            fill: #ef4444;
            r: 6;
        }
        @media (max-width: 768px) {
            .responsive-text {
                font-size: 1rem;
            }
            .responsive-formula {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 transition-all duration-500">
    
    <!-- 暗黑模式切换按钮 -->
    <button id="darkModeToggle" class="fixed top-4 right-4 z-50 p-3 bg-white dark:bg-gray-800 rounded-full shadow-lg hover:shadow-xl transition-all duration-300">
        <i class="fas fa-moon dark:hidden text-gray-600"></i>
        <i class="fas fa-sun hidden dark:block text-yellow-400"></i>
    </button>

    <!-- 主要内容区域 -->
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        
        <!-- 标题区域 -->
        <header class="text-center mb-12 animate-fade-in">
            <h1 class="text-4xl md:text-6xl font-bold gradient-text mb-4">求导</h1>
            <p class="text-lg md:text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto">
                导数是微积分的核心概念，描述了函数在某点的瞬时变化率，是理解函数性质和解决实际问题的重要工具
            </p>
            <div class="flex justify-center items-center mt-6 space-x-4">
                <span class="px-4 py-2 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">高等数学</span>
                <span class="px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium">微积分</span>
                <span class="px-4 py-2 bg-purple-100 text-purple-800 rounded-full text-sm font-medium">导数</span>
            </div>
        </header>

        <!-- 核心概念卡片 -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
            
            <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg hover-lift animate-fade-in">
                <div class="flex items-center mb-4">
                    <i class="fas fa-question-circle text-3xl text-blue-500 mr-3"></i>
                    <h3 class="text-xl font-bold text-gray-800 dark:text-white">什么是导数？</h3>
                </div>
                <p class="text-gray-600 dark:text-gray-300 mb-4">
                    导数表示函数在某点的瞬时变化率，几何上表现为该点处切线的斜率。
                </p>
                <div class="bg-blue-50 dark:bg-gray-700 p-4 rounded-lg">
                    <p class="text-sm font-medium text-blue-800 dark:text-blue-300">
                        定义：$f'(x_0) = \lim_{h \to 0} \frac{f(x_0 + h) - f(x_0)}{h}$
                    </p>
                </div>
            </div>

            <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg hover-lift animate-fade-in">
                <div class="flex items-center mb-4">
                    <i class="fas fa-calculator text-3xl text-green-500 mr-3"></i>
                    <h3 class="text-xl font-bold text-gray-800 dark:text-white">基本求导法则</h3>
                </div>
                <div class="space-y-3 text-sm">
                    <div class="bg-green-50 dark:bg-gray-700 p-3 rounded">
                        <strong>幂函数：</strong> $(x^n)' = nx^{n-1}$
                    </div>
                    <div class="bg-green-50 dark:bg-gray-700 p-3 rounded">
                        <strong>指数函数：</strong> $(e^x)' = e^x$
                    </div>
                    <div class="bg-green-50 dark:bg-gray-700 p-3 rounded">
                        <strong>对数函数：</strong> $(\ln x)' = \frac{1}{x}$
                    </div>
                </div>
            </div>

            <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg hover-lift animate-fade-in">
                <div class="flex items-center mb-4">
                    <i class="fas fa-cogs text-3xl text-purple-500 mr-3"></i>
                    <h3 class="text-xl font-bold text-gray-800 dark:text-white">运算法则</h3>
                </div>
                <div class="space-y-3 text-sm">
                    <div class="bg-purple-50 dark:bg-gray-700 p-3 rounded">
                        <strong>加法：</strong> $(u + v)' = u' + v'$
                    </div>
                    <div class="bg-purple-50 dark:bg-gray-700 p-3 rounded">
                        <strong>乘法：</strong> $(uv)' = u'v + uv'$
                    </div>
                    <div class="bg-purple-50 dark:bg-gray-700 p-3 rounded">
                        <strong>链式：</strong> $(f(g(x)))' = f'(g(x)) \cdot g'(x)$
                    </div>
                </div>
            </div>
        </div>

        <!-- 详细理论解释 -->
        <div class="bg-white dark:bg-gray-800 rounded-xl p-8 shadow-lg mb-12 animate-fade-in">
            <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-6 flex items-center">
                <i class="fas fa-book text-blue-500 mr-3"></i>
                导数的理论基础
            </h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-xl font-semibold mb-4 text-gray-700 dark:text-gray-300">几何意义</h3>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">
                        导数的几何意义是函数图像在该点处的切线斜率。当我们考虑函数 $y = f(x)$ 在点 $(x_0, f(x_0))$ 处的导数时，
                        实际上是在求通过该点的切线的斜率。
                    </p>
                    
                    <h3 class="text-xl font-semibold mb-4 text-gray-700 dark:text-gray-300">物理意义</h3>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">
                        在物理学中，导数表示变化率。例如：
                    </p>
                    <ul class="list-disc list-inside text-gray-600 dark:text-gray-400 space-y-2">
                        <li>位移对时间的导数是速度</li>
                        <li>速度对时间的导数是加速度</li>
                        <li>电荷对时间的导数是电流</li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-xl font-semibold mb-4 text-gray-700 dark:text-gray-300">导数的定义</h3>
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                        <div class="text-center mb-4">
                            <p class="text-lg font-medium mb-2">函数 $f(x)$ 在点 $x_0$ 处的导数定义为：</p>
                            <div class="text-xl">
                                $$f'(x_0) = \lim_{h \to 0} \frac{f(x_0 + h) - f(x_0)}{h}$$
                            </div>
                        </div>
                        <div class="mt-4 text-sm text-gray-600 dark:text-gray-400">
                            <p><strong>参数解释：</strong></p>
                            <ul class="list-disc list-inside mt-2 space-y-1">
                                <li>$h$：自变量的增量</li>
                                <li>$f(x_0 + h) - f(x_0)$：函数值的增量</li>
                                <li>$\frac{f(x_0 + h) - f(x_0)}{h}$：平均变化率</li>
                                <li>当 $h \to 0$ 时的极限：瞬时变化率</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 交互式导数演示 -->
        <div class="bg-white dark:bg-gray-800 rounded-xl p-8 shadow-lg mb-12 animate-fade-in">
            <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-6 flex items-center">
                <i class="fas fa-chart-line text-green-500 mr-3"></i>
                交互式导数可视化
            </h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-xl font-semibold mb-4 text-gray-700 dark:text-gray-300">控制面板</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">选择函数：</label>
                            <select id="functionSelect" class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                                <option value="quadratic">二次函数: f(x) = x²</option>
                                <option value="cubic">三次函数: f(x) = x³</option>
                                <option value="sin">正弦函数: f(x) = sin(x)</option>
                                <option value="exp">指数函数: f(x) = eˣ</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                切点位置: <span id="pointValue">x = 1</span>
                            </label>
                            <input type="range" id="pointSlider" min="-3" max="3" step="0.1" value="1" 
                                   class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                        </div>
                        
                        <div class="bg-blue-50 dark:bg-gray-700 p-4 rounded-lg">
                            <h4 class="font-semibold text-blue-800 dark:text-blue-300 mb-2">当前信息：</h4>
                            <div id="derivativeInfo" class="text-sm text-blue-700 dark:text-blue-400">
                                <p>点坐标: (1, 1)</p>
                                <p>导数值: f'(1) = 2</p>
                                <p>切线斜率: k = 2</p>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button id="playAnimation" class="flex-1 bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors">
                                <i class="fas fa-play mr-2"></i>播放动画
                            </button>
                            <button id="resetAnimation" class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                                <i class="fas fa-redo mr-2"></i>重置
                            </button>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-xl font-semibold mb-4 text-gray-700 dark:text-gray-300">函数图像与切线</h3>
                    <div class="relative">
                        <svg id="derivativeCanvas" width="100%" height="400" viewBox="-50 -250 400 500" 
                             class="border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700">
                            <!-- 坐标轴 -->
                            <defs>
                                <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                                        refX="10" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#666" />
                                </marker>
                            </defs>
                            
                            <!-- X轴 -->
                            <line x1="-40" y1="0" x2="360" y2="0" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
                            <!-- Y轴 -->
                            <line x1="150" y1="240" x2="150" y2="-240" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
                            
                            <!-- 网格线 -->
                            <g stroke="#e5e7eb" stroke-width="1" opacity="0.5">
                                <!-- 垂直网格线 -->
                                <line x1="50" y1="-240" x2="50" y2="240"/>
                                <line x1="100" y1="-240" x2="100" y2="240"/>
                                <line x1="200" y1="-240" x2="200" y2="240"/>
                                <line x1="250" y1="-240" x2="250" y2="240"/>
                                <line x1="300" y1="-240" x2="300" y2="240"/>
                                <!-- 水平网格线 -->
                                <line x1="-40" y1="-200" x2="360" y2="-200"/>
                                <line x1="-40" y1="-100" x2="360" y2="-100"/>
                                <line x1="-40" y1="100" x2="360" y2="100"/>
                                <line x1="-40" y1="200" x2="360" y2="200"/>
                            </g>
                            
                            <!-- 函数曲线 -->
                            <path id="functionCurve" class="function-curve"/>
                            
                            <!-- 切线 -->
                            <line id="tangentLine" class="tangent-line"/>
                            
                            <!-- 点标记 -->
                            <circle id="pointMarker" class="point-marker"/>
                            
                            <!-- 坐标标签 -->
                            <text x="360" y="15" font-size="14" fill="#666">x</text>
                            <text x="160" y="-230" font-size="14" fill="#666">y</text>
                        </svg>
                    </div>
                </div>
            </div>
        </div>

        <!-- 求导法则详解 -->
        <div class="bg-white dark:bg-gray-800 rounded-xl p-8 shadow-lg mb-12 animate-fade-in">
            <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-6 flex items-center">
                <i class="fas fa-list text-indigo-500 mr-3"></i>
                常用求导法则与公式
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-xl font-semibold mb-4 text-indigo-600 dark:text-indigo-400">基本导数公式</h3>
                    <div class="space-y-4">
                        <div class="bg-indigo-50 dark:bg-gray-700 p-4 rounded-lg">
                            <div class="flex justify-between items-center">
                                <span class="font-medium">常数函数：</span>
                                <span class="font-mono">$(C)' = 0$</span>
                            </div>
                        </div>
                        <div class="bg-indigo-50 dark:bg-gray-700 p-4 rounded-lg">
                            <div class="flex justify-between items-center">
                                <span class="font-medium">幂函数：</span>
                                <span class="font-mono">$(x^n)' = nx^{n-1}$</span>
                            </div>
                        </div>
                        <div class="bg-indigo-50 dark:bg-gray-700 p-4 rounded-lg">
                            <div class="flex justify-between items-center">
                                <span class="font-medium">指数函数：</span>
                                <span class="font-mono">$(e^x)' = e^x$</span>
                            </div>
                        </div>
                        <div class="bg-indigo-50 dark:bg-gray-700 p-4 rounded-lg">
                            <div class="flex justify-between items-center">
                                <span class="font-medium">对数函数：</span>
                                <span class="font-mono">$(\ln x)' = \frac{1}{x}$</span>
                            </div>
                        </div>
                        <div class="bg-indigo-50 dark:bg-gray-700 p-4 rounded-lg">
                            <div class="flex justify-between items-center">
                                <span class="font-medium">正弦函数：</span>
                                <span class="font-mono">$(\sin x)' = \cos x$</span>
                            </div>
                        </div>
                        <div class="bg-indigo-50 dark:bg-gray-700 p-4 rounded-lg">
                            <div class="flex justify-between items-center">
                                <span class="font-medium">余弦函数：</span>
                                <span class="font-mono">$(\cos x)' = -\sin x$</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-xl font-semibold mb-4 text-green-600 dark:text-green-400">运算法则</h3>
                    <div class="space-y-4">
                        <div class="bg-green-50 dark:bg-gray-700 p-4 rounded-lg">
                            <div class="font-medium mb-2">线性规则：</div>
                            <div class="font-mono text-sm">$(af(x) + bg(x))' = af'(x) + bg'(x)$</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400 mt-1">常数因子可提出，加减法逐项求导</div>
                        </div>
                        <div class="bg-green-50 dark:bg-gray-700 p-4 rounded-lg">
                            <div class="font-medium mb-2">乘积法则：</div>
                            <div class="font-mono text-sm">$(uv)' = u'v + uv'$</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400 mt-1">两函数乘积的导数</div>
                        </div>
                        <div class="bg-green-50 dark:bg-gray-700 p-4 rounded-lg">
                            <div class="font-medium mb-2">商法则：</div>
                            <div class="font-mono text-sm">$\left(\frac{u}{v}\right)' = \frac{u'v - uv'}{v^2}$</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400 mt-1">两函数商的导数</div>
                        </div>
                        <div class="bg-green-50 dark:bg-gray-700 p-4 rounded-lg">
                            <div class="font-medium mb-2">链式法则：</div>
                            <div class="font-mono text-sm">$(f(g(x)))' = f'(g(x)) \cdot g'(x)$</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400 mt-1">复合函数的导数</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 实际应用案例 -->
        <div class="bg-white dark:bg-gray-800 rounded-xl p-8 shadow-lg mb-12 animate-fade-in">
            <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-6 flex items-center">
                <i class="fas fa-rocket text-red-500 mr-3"></i>
                导数的实际应用
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-gray-700 dark:to-gray-600 p-6 rounded-lg">
                    <div class="text-center mb-4">
                        <i class="fas fa-car text-4xl text-blue-500 mb-2"></i>
                        <h3 class="text-lg font-bold text-blue-800 dark:text-blue-300">物理运动</h3>
                    </div>
                    <p class="text-sm text-blue-700 dark:text-blue-400 mb-3">
                        位移函数 $s(t) = 5t^2 + 2t + 1$ 的导数是速度：
                    </p>
                    <div class="bg-white dark:bg-gray-800 p-3 rounded text-center">
                        <div class="font-mono text-sm">$v(t) = s'(t) = 10t + 2$</div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-br from-green-50 to-green-100 dark:from-gray-700 dark:to-gray-600 p-6 rounded-lg">
                    <div class="text-center mb-4">
                        <i class="fas fa-chart-area text-4xl text-green-500 mb-2"></i>
                        <h3 class="text-lg font-bold text-green-800 dark:text-green-300">经济学</h3>
                    </div>
                    <p class="text-sm text-green-700 dark:text-green-400 mb-3">
                        成本函数 $C(x) = x^3 - 6x^2 + 12x$ 的边际成本：
                    </p>
                    <div class="bg-white dark:bg-gray-800 p-3 rounded text-center">
                        <div class="font-mono text-sm">$MC = C'(x) = 3x^2 - 12x + 12$</div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-br from-purple-50 to-purple-100 dark:from-gray-700 dark:to-gray-600 p-6 rounded-lg">
                    <div class="text-center mb-4">
                        <i class="fas fa-mountain text-4xl text-purple-500 mb-2"></i>
                        <h3 class="text-lg font-bold text-purple-800 dark:text-purple-300">优化问题</h3>
                    </div>
                    <p class="text-sm text-purple-700 dark:text-purple-400 mb-3">
                        寻找函数 $f(x) = x^3 - 3x + 1$ 的极值点：
                    </p>
                    <div class="bg-white dark:bg-gray-800 p-3 rounded text-center">
                        <div class="font-mono text-sm">$f'(x) = 3x^2 - 3 = 0$</div>
                        <div class="font-mono text-xs mt-1">$x = \pm 1$</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 求导练习生成器 -->
        <div class="bg-white dark:bg-gray-800 rounded-xl p-8 shadow-lg mb-12 animate-fade-in">
            <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-6 flex items-center">
                <i class="fas fa-brain text-orange-500 mr-3"></i>
                智能练习生成器
            </h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-xl font-semibold mb-4 text-gray-700 dark:text-gray-300">生成设置</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">题目类型：</label>
                            <select id="exerciseType" class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700">
                                <option value="basic">基本函数求导</option>
                                <option value="product">乘积法则</option>
                                <option value="quotient">商法则</option>
                                <option value="chain">链式法则</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">难度级别：</label>
                            <select id="difficultyLevel" class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700">
                                <option value="easy">简单</option>
                                <option value="medium">中等</option>
                                <option value="hard">困难</option>
                            </select>
                        </div>
                        
                        <button id="generateExercise" class="w-full bg-orange-500 text-white px-6 py-3 rounded-lg hover:bg-orange-600 transition-colors font-medium">
                            <i class="fas fa-dice mr-2"></i>生成新题目
                        </button>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-xl font-semibold mb-4 text-gray-700 dark:text-gray-300">练习题目</h3>
                    
                    <div id="exerciseDisplay" class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg min-h-[200px]">
                        <div class="text-center text-gray-500 dark:text-gray-400">
                            <i class="fas fa-lightbulb text-4xl mb-3"></i>
                            <p>点击"生成新题目"开始练习</p>
                        </div>
                    </div>
                    
                    <div id="exerciseAnswer" class="mt-4 p-4 bg-blue-50 dark:bg-gray-600 rounded-lg" style="display: none;">
                        <h4 class="font-semibold text-blue-800 dark:text-blue-300 mb-2">参考答案：</h4>
                        <div id="answerContent" class="text-blue-700 dark:text-blue-400"></div>
                        <button id="showSteps" class="mt-2 text-sm bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition-colors">
                            显示详细步骤
                        </button>
                    </div>
                    
                    <div id="exerciseSteps" class="mt-4 p-4 bg-green-50 dark:bg-gray-600 rounded-lg" style="display: none;">
                        <h4 class="font-semibold text-green-800 dark:text-green-300 mb-2">解题步骤：</h4>
                        <div id="stepsContent" class="text-green-700 dark:text-green-400"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 思考题区域 -->
    <div class="fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <i class="fas fa-lightbulb text-yellow-500 text-xl"></i>
                    <div>
                        <h4 class="font-semibold text-gray-800 dark:text-white">思考题</h4>
                        <p class="text-sm text-gray-600 dark:text-gray-300">为什么常数的导数为零？导数的链式法则为什么重要？</p>
                    </div>
                </div>
                <button class="text-blue-500 hover:text-blue-600 transition-colors">
                    <i class="fas fa-chevron-up text-xl"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- 页脚 -->
    <footer class="bg-gray-100 dark:bg-gray-900 mt-20 py-8">
        <div class="container mx-auto px-4 text-center">
            <div class="mb-4">
                <p class="text-lg font-semibold text-gray-800 dark:text-white">IECUBE Tutorial</p>
                <p class="text-gray-600 dark:text-gray-400">© 2025 版权所有</p>
            </div>
            <p class="text-xs text-gray-500 dark:text-gray-500">
                本内容为人工智能生成，观点为转述原作者，不代表本公司立场，仅供参考和批判
            </p>
        </div>
    </footer>

    <script>
        // 暗黑模式切换
        const darkModeToggle = document.getElementById('darkModeToggle');
        const htmlElement = document.documentElement;
        
        function toggleDarkMode() {
            htmlElement.classList.toggle('dark');
            localStorage.setItem('darkMode', htmlElement.classList.contains('dark'));
            updateDarkModeIcon();
        }
        
        function updateDarkModeIcon() {
            const isDark = htmlElement.classList.contains('dark');
            document.querySelector('.fa-moon').style.display = isDark ? 'none' : 'block';
            document.querySelector('.fa-sun').style.display = isDark ? 'block' : 'none';
        }
        
        // 检查系统偏好设置
        if (localStorage.getItem('darkMode') === 'true' || 
            (!localStorage.getItem('darkMode') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            htmlElement.classList.add('dark');
        }
        updateDarkModeIcon();
        
        darkModeToggle.addEventListener('click', toggleDarkMode);

        // 渲染数学公式
        document.addEventListener('DOMContentLoaded', function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false}
                ]
            });
        });

        // 导数可视化功能
        class DerivativeVisualizer {
            constructor() {
                this.currentFunction = 'quadratic';
                this.currentPoint = 1;
                this.scale = 50;
                this.centerX = 150;
                this.centerY = 0;
                
                this.initializeElements();
                this.setupEventListeners();
                this.updateVisualization();
            }
            
            initializeElements() {
                this.functionSelect = document.getElementById('functionSelect');
                this.pointSlider = document.getElementById('pointSlider');
                this.pointValue = document.getElementById('pointValue');
                this.derivativeInfo = document.getElementById('derivativeInfo');
                this.functionCurve = document.getElementById('functionCurve');
                this.tangentLine = document.getElementById('tangentLine');
                this.pointMarker = document.getElementById('pointMarker');
                this.playButton = document.getElementById('playAnimation');
                this.resetButton = document.getElementById('resetAnimation');
            }
            
            setupEventListeners() {
                this.functionSelect.addEventListener('change', () => {
                    this.currentFunction = this.functionSelect.value;
                    this.updateVisualization();
                });
                
                this.pointSlider.addEventListener('input', () => {
                    this.currentPoint = parseFloat(this.pointSlider.value);
                    this.updateVisualization();
                });
                
                this.playButton.addEventListener('click', () => this.playAnimation());
                this.resetButton.addEventListener('click', () => this.reset());
            }
            
            getFunction(x) {
                switch(this.currentFunction) {
                    case 'quadratic':
                        return x * x;
                    case 'cubic':
                        return x * x * x;
                    case 'sin':
                        return Math.sin(x);
                    case 'exp':
                        return Math.exp(x);
                    default:
                        return x * x;
                }
            }
            
            getDerivative(x) {
                switch(this.currentFunction) {
                    case 'quadratic':
                        return 2 * x;
                    case 'cubic':
                        return 3 * x * x;
                    case 'sin':
                        return Math.cos(x);
                    case 'exp':
                        return Math.exp(x);
                    default:
                        return 2 * x;
                }
            }
            
            getFunctionName() {
                switch(this.currentFunction) {
                    case 'quadratic':
                        return 'f(x) = x²';
                    case 'cubic':
                        return 'f(x) = x³';
                    case 'sin':
                        return 'f(x) = sin(x)';
                    case 'exp':
                        return 'f(x) = eˣ';
                    default:
                        return 'f(x) = x²';
                }
            }
            
            getDerivativeName() {
                switch(this.currentFunction) {
                    case 'quadratic':
                        return "f'(x) = 2x";
                    case 'cubic':
                        return "f'(x) = 3x²";
                    case 'sin':
                        return "f'(x) = cos(x)";
                    case 'exp':
                        return "f'(x) = eˣ";
                    default:
                        return "f'(x) = 2x";
                }
            }
            
            updateVisualization() {
                this.pointValue.textContent = `x = ${this.currentPoint}`;
                
                // 绘制函数曲线
                this.drawFunctionCurve();
                
                // 绘制切线和点
                this.drawTangentLine();
                this.drawPoint();
                
                // 更新信息显示
                this.updateInfo();
            }
            
            drawFunctionCurve() {
                let pathData = '';
                const startX = -3;
                const endX = 3;
                const step = 0.1;
                
                for (let x = startX; x <= endX; x += step) {
                    const screenX = this.centerX + x * this.scale;
                    const y = this.getFunction(x);
                    const screenY = this.centerY - y * this.scale;
                    
                    if (x === startX) {
                        pathData += `M ${screenX} ${screenY}`;
                    } else {
                        pathData += ` L ${screenX} ${screenY}`;
                    }
                }
                
                this.functionCurve.setAttribute('d', pathData);
            }
            
            drawTangentLine() {
                const x = this.currentPoint;
                const y = this.getFunction(x);
                const slope = this.getDerivative(x);
                
                const screenX = this.centerX + x * this.scale;
                const screenY = this.centerY - y * this.scale;
                
                // 切线延伸长度
                const lineLength = 100;
                const x1 = screenX - lineLength;
                const y1 = screenY + slope * lineLength / this.scale;
                const x2 = screenX + lineLength;
                const y2 = screenY - slope * lineLength / this.scale;
                
                this.tangentLine.setAttribute('x1', x1);
                this.tangentLine.setAttribute('y1', y1);
                this.tangentLine.setAttribute('x2', x2);
                this.tangentLine.setAttribute('y2', y2);
            }
            
            drawPoint() {
                const x = this.currentPoint;
                const y = this.getFunction(x);
                
                const screenX = this.centerX + x * this.scale;
                const screenY = this.centerY - y * this.scale;
                
                this.pointMarker.setAttribute('cx', screenX);
                this.pointMarker.setAttribute('cy', screenY);
            }
            
            updateInfo() {
                const x = this.currentPoint;
                const y = this.getFunction(x);
                const derivative = this.getDerivative(x);
                
                this.derivativeInfo.innerHTML = `
                    <p>函数: ${this.getFunctionName()}</p>
                    <p>点坐标: (${x.toFixed(2)}, ${y.toFixed(2)})</p>
                    <p>导数: ${this.getDerivativeName()}</p>
                    <p>导数值: f'(${x.toFixed(2)}) = ${derivative.toFixed(2)}</p>
                    <p>切线斜率: k = ${derivative.toFixed(2)}</p>
                `;
            }
            
            playAnimation() {
                let startPoint = -2.5;
                let endPoint = 2.5;
                let currentPoint = startPoint;
                let direction = 1;
                
                const animate = () => {
                    currentPoint += direction * 0.05;
                    
                    if (currentPoint >= endPoint || currentPoint <= startPoint) {
                        direction *= -1;
                    }
                    
                    this.currentPoint = currentPoint;
                    this.pointSlider.value = currentPoint;
                    this.updateVisualization();
                    
                    setTimeout(() => requestAnimationFrame(animate), 50);
                };
                
                animate();
            }
            
            reset() {
                this.currentPoint = 1;
                this.pointSlider.value = 1;
                this.updateVisualization();
            }
        }

        // 练习生成器
        class ExerciseGenerator {
            constructor() {
                this.setupEventListeners();
            }
            
            setupEventListeners() {
                document.getElementById('generateExercise').addEventListener('click', () => {
                    this.generateExercise();
                });
                
                document.getElementById('showSteps').addEventListener('click', () => {
                    document.getElementById('exerciseSteps').style.display = 'block';
                });
            }
            
            generateExercise() {
                const type = document.getElementById('exerciseType').value;
                const difficulty = document.getElementById('difficultyLevel').value;
                
                let exercise = this.createExercise(type, difficulty);
                
                document.getElementById('exerciseDisplay').innerHTML = `
                    <div class="text-center">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white">求导题目</h4>
                        <div class="text-xl mb-4">${exercise.question}</div>
                        <button onclick="this.parentElement.parentElement.nextElementSibling.style.display='block'" 
                                class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors">
                            查看答案
                        </button>
                    </div>
                `;
                
                document.getElementById('answerContent').innerHTML = exercise.answer;
                document.getElementById('stepsContent').innerHTML = exercise.steps;
                document.getElementById('exerciseAnswer').style.display = 'none';
                document.getElementById('exerciseSteps').style.display = 'none';
            }
            
            createExercise(type, difficulty) {
                switch(type) {
                    case 'basic':
                        return this.createBasicExercise(difficulty);
                    case 'product':
                        return this.createProductExercise(difficulty);
                    case 'quotient':
                        return this.createQuotientExercise(difficulty);
                    case 'chain':
                        return this.createChainExercise(difficulty);
                    default:
                        return this.createBasicExercise(difficulty);
                }
            }
            
            createBasicExercise(difficulty) {
                const exercises = {
                    easy: [
                        {
                            question: "求函数 $f(x) = x^3$ 的导数",
                            answer: "$f'(x) = 3x^2$",
                            steps: "1. 使用幂函数求导公式 $(x^n)' = nx^{n-1}$<br>2. $f'(x) = 3x^{3-1} = 3x^2$"
                        },
                        {
                            question: "求函数 $f(x) = 2x^2 + 5x + 1$ 的导数",
                            answer: "$f'(x) = 4x + 5$",
                            steps: "1. 使用线性性质逐项求导<br>2. $(2x^2)' = 4x$<br>3. $(5x)' = 5$<br>4. $(1)' = 0$<br>5. $f'(x) = 4x + 5 + 0 = 4x + 5$"
                        }
                    ],
                    medium: [
                        {
                            question: "求函数 $f(x) = x^2 e^x$ 的导数",
                            answer: "$f'(x) = 2xe^x + x^2e^x = xe^x(2 + x)$",
                            steps: "1. 使用乘积法则 $(uv)' = u'v + uv'$<br>2. 设 $u = x^2$, $v = e^x$<br>3. $u' = 2x$, $v' = e^x$<br>4. $f'(x) = 2x \cdot e^x + x^2 \cdot e^x = xe^x(2 + x)$"
                        }
                    ],
                    hard: [
                        {
                            question: "求函数 $f(x) = \\sin(x^2 + 1)$ 的导数",
                            answer: "$f'(x) = 2x\\cos(x^2 + 1)$",
                            steps: "1. 使用链式法则 $(f(g(x)))' = f'(g(x)) \\cdot g'(x)$<br>2. 设外函数 $f(u) = \\sin u$, 内函数 $g(x) = x^2 + 1$<br>3. $f'(u) = \\cos u$, $g'(x) = 2x$<br>4. $f'(x) = \\cos(x^2 + 1) \\cdot 2x = 2x\\cos(x^2 + 1)$"
                        }
                    ]
                };
                
                const levelExercises = exercises[difficulty];
                const randomIndex = Math.floor(Math.random() * levelExercises.length);
                return levelExercises[randomIndex];
            }
            
            createProductExercise(difficulty) {
                return {
                    question: "求函数 $f(x) = x^2 \\sin x$ 的导数",
                    answer: "$f'(x) = 2x\\sin x + x^2\\cos x$",
                    steps: "1. 使用乘积法则 $(uv)' = u'v + uv'$<br>2. 设 $u = x^2$, $v = \\sin x$<br>3. $u' = 2x$, $v' = \\cos x$<br>4. $f'(x) = 2x \\cdot \\sin x + x^2 \\cdot \\cos x$"
                };
            }
            
            createQuotientExercise(difficulty) {
                return {
                    question: "求函数 $f(x) = \\frac{x^2}{x + 1}$ 的导数",
                    answer: "$f'(x) = \\frac{x(x + 2)}{(x + 1)^2}$",
                    steps: "1. 使用商法则 $(\\frac{u}{v})' = \\frac{u'v - uv'}{v^2}$<br>2. 设 $u = x^2$, $v = x + 1$<br>3. $u' = 2x$, $v' = 1$<br>4. $f'(x) = \\frac{2x(x + 1) - x^2 \\cdot 1}{(x + 1)^2} = \\frac{2x^2 + 2x - x^2}{(x + 1)^2} = \\frac{x^2 + 2x}{(x + 1)^2} = \\frac{x(x + 2)}{(x + 1)^2}$"
                };
            }
            
            createChainExercise(difficulty) {
                return {
                    question: "求函数 $f(x) = e^{3x^2 + 2x}$ 的导数",
                    answer: "$f'(x) = (6x + 2)e^{3x^2 + 2x}$",
                    steps: "1. 使用链式法则 $(f(g(x)))' = f'(g(x)) \\cdot g'(x)$<br>2. 设外函数 $f(u) = e^u$, 内函数 $g(x) = 3x^2 + 2x$<br>3. $f'(u) = e^u$, $g'(x) = 6x + 2$<br>4. $f'(x) = e^{3x^2 + 2x} \\cdot (6x + 2) = (6x + 2)e^{3x^2 + 2x}$"
                };
            }
        }

        // 初始化功能
        document.addEventListener('DOMContentLoaded', function() {
            new DerivativeVisualizer();
            new ExerciseGenerator();
            
            // 添加滚动动画效果
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, observerOptions);
            
            document.querySelectorAll('.animate-fade-in').forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(el);
            });
        });
    </script>
</body>
</html>